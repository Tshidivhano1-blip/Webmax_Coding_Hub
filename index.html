<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Webmax Coding Hub - Play to Learn</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        /* Custom styles for the new light UI */
        body {
            font-family: 'Inter', sans-serif;
        }

        /* New button style with a subtle shadow */
        .btn {
            background-color: #3b82f6; /* Tailwind blue-500 */
            transition: all 0.3s ease-in-out;
            box-shadow: 0 4px 14px 0 rgba(59, 130, 246, 0.39);
        }
        .btn:hover {
            transform: scale(1.05) translateY(-1px);
            box-shadow: 0 6px 20px 0 rgba(59, 130, 246, 0.45);
        }

        /* Section title with blue underline */
        .section-title {
            position: relative;
        }
        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background-color: #3b82f6; /* Blue accent */
            border-radius: 2px;
        }

        /* New card style with shadow lift on hover */
        .content-card {
            background-color: #ffffff; /* White */
            border: 1px solid #e5e7eb; /* Tailwind gray-200 */
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
            transition: all 0.3s ease-in-out;
        }
        .content-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05);
        }
        
        /* Reveal on scroll animation */
        .reveal {
            opacity: 0;
            transform: translateY(50px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }

        .reveal.visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* Typing Game Specific Styles for Light Mode */
        .text-char {
            transition: color 0.2s, background-color 0.2s;
        }
        .correct {
            color: #16a34a; /* Tailwind green-600 */
        }
        .incorrect {
            color: #dc2626; /* Tailwind red-600 */
        }
        .current {
            background-color: #dbeafe; /* Tailwind blue-100 */
            border-radius: 2px;
            padding: 1px 0;
        }
    </style>
</head>
<body class="overflow-x-hidden bg-slate-50 text-slate-800">

    <!-- Header -->
    <header class="p-4 md:p-6 fixed top-0 left-0 right-0 z-50 bg-white/80 backdrop-blur-sm border-b border-slate-200">
        <div class="container mx-auto flex justify-between items-center">
            <a href="#" class="flex items-center gap-3 text-2xl font-bold text-slate-800">
                <img src="https://i.postimg.cc/TPv5bw39/Coding-Academy-LOGO.png" alt="Webmax Coding Hub Logo" class="rounded-full h-12 w-12 object-cover">
                <span><span class="text-blue-500">&lt;</span>Webmax<span class="text-blue-500">/&gt;</span> Coding Hub</span>
            </a>
            <nav class="hidden md:flex space-x-8 items-center text-slate-600 font-semibold">
                <a href="#games" class="hover:text-blue-500 transition-colors">Games</a>
                <a href="#simulations" class="hover:text-blue-500 transition-colors">Simulations</a>
                <a href="#tech" class="hover:text-blue-500 transition-colors">More</a>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main>

        <!-- Hero Section -->
        <section class="relative min-h-screen flex items-center justify-center text-center text-white p-4 pt-20">
            <!-- Background Image -->
            <img src="https://i.postimg.cc/x8HtdLbG/hero.png" alt="Background of kids and coding elements" class="absolute inset-0 w-full h-full object-cover z-0">
            <!-- Overlay -->
            <div class="absolute inset-0 bg-slate-900/70 z-10"></div>

            <!-- Content -->
            <div class="relative z-20">
                <h1 class="text-5xl md:text-7xl font-black mb-4 leading-tight">Welcome to Webmax Coding Hub</h1>
                <p class="text-xl md:text-2xl mb-8 max-w-3xl mx-auto">Play to Learn ‚Äì Discover coding through games, activities, and fun challenges.</p>
                <a href="#games" class="inline-block px-8 py-3 font-bold text-white rounded-full btn">Start Playing</a>
            </div>
        </section>

        <!-- Intro Video Section -->
        <section class="py-20 px-4 bg-slate-100 reveal">
            <div class="container mx-auto max-w-4xl text-center">
                 <div style="position:relative; width:100%; height:0px; padding-bottom:56.250%"><iframe allow="fullscreen" allowfullscreen height="100%" src="https://streamable.com/e/7cx8i3?" width="100%" style="border:none; width:100%; height:100%; position:absolute; left:0px; top:0px; overflow:hidden;"></iframe></div>
                 <p class="mt-6 text-lg text-slate-600">Watch how Webmax turns learning into play.</p>
            </div>
        </section>

        <!-- Coding Games Section -->
        <section id="games" class="py-20 px-4 reveal">
            <div class="container mx-auto">
                <h2 class="section-title text-4xl md:text-5xl font-bold text-slate-800 text-center pb-4 mb-12">Coding Games</h2>
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <!-- Game Card 1 -->
                    <div class="content-card rounded-2xl">
                        <img src="media/robocode.png" alt="Robocode Game" class="w-full h-48 object-cover">
                        <div class="p-6 text-center">
                            <h3 class="text-2xl font-bold mb-2 text-slate-800">Robocode</h3>
                            <p class="text-slate-600 mb-6">Code your own robot battle tank to compete against others in this classic programming game.</p>
                            <a href="coding_games/robocode.html" class="inline-block px-8 py-3 font-bold text-white rounded-full btn">Play Game</a>
                        </div>
                    </div>
                    <!-- Game Card 2 -->
                    <div class="content-card rounded-2xl">
                        <img src="media/codefarmer.png" alt="CodeGardener Game" class="w-full h-48 object-cover">
                        <div class="p-6 text-center">
                            <h3 class="text-2xl font-bold mb-2 text-slate-800">CodeGardener</h3>
                            <p class="text-slate-600 mb-6">Grow a beautiful garden by writing JavaScript code to plant and nurture your flowers.</p>
                            <a href="coding_games/codefarm.html" class="inline-block px-8 py-3 font-bold text-white rounded-full btn">Play Game</a>
                        </div>
                    </div>
                    <!-- Game Card 3 -->
                    <div class="content-card rounded-2xl">
                        <img src="media/codefactory.png" alt="CodeFactory Game" class="w-full h-48 object-cover">
                        <div class="p-6 text-center">
                            <h3 class="text-2xl font-bold mb-2 text-slate-800">CodeFactory</h3>
                            <p class="text-slate-600 mb-6">Manage a virtual factory and automate complex production lines using Python logic.</p>
                            <a href="coding_games/codefactory.html" class="inline-block px-8 py-3 font-bold text-white rounded-full btn">Play Game</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Brain Boosting Games Section -->
        <section class="py-20 px-4 bg-slate-100 reveal">
            <div class="container mx-auto">
                <h2 class="section-title text-4xl md:text-5xl font-bold text-slate-800 text-center pb-4 mb-12">Brain Boosting Games</h2>
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <!-- Brain Game Card 1 -->
                    <div class="content-card rounded-2xl">
                        <img src="media/mathsnake.jpg" alt="Snake Math" class="w-full h-48 object-cover">
                        <div class="p-6 text-center">
                            <h3 class="text-2xl font-bold mb-2 text-slate-800">Snake Math</h3>
                            <p class="text-slate-600 mb-6">A classic arcade game with a twist! Guide your snake to solve math problems and grow longer.</p>
                            <a href="brainboostgames/mathsnake.html" class="inline-block px-8 py-3 font-bold text-white rounded-full btn">Play Now</a>
                        </div>
                    </div>
                    <!-- Brain Game Card 2 -->
                    <div class="content-card rounded-2xl">
                        <img src="media/ballon.png" alt="Balloon Pop Math" class="w-full h-48 object-cover">
                        <div class="p-6 text-center">
                            <h3 class="text-2xl font-bold mb-2 text-slate-800">Balloon Pop Math</h3>
                            <p class="text-slate-600 mb-6">Solve math sums by popping the correct balloon. A colorful and fun reflex game.</p>
                            <a href="brainboostgames/ballonpop.html" class="inline-block px-8 py-3 font-bold text-white rounded-full btn">Play Now</a>
                        </div>
                    </div>
                    <!-- Brain Game Card 3 -->
                    <div class="content-card rounded-2xl">
                        <img src="media/quiz.jpg" alt="Einstein IQ Quiz" class="w-full h-48 object-cover">
                        <div class="p-6 text-center">
                            <h3 class="text-2xl font-bold mb-2 text-slate-800">Einstein IQ Quiz</h3>
                            <p class="text-slate-600 mb-6">A challenging quiz-style game with math and science questions to test your logic.</p>
                            <a href="brainboostgames/iq.html" class="inline-block px-8 py-3 font-bold text-white rounded-full btn">Play Now</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Tech Forward Section -->
        <section id="tech" class="py-20 px-4 reveal">
            <div class="container mx-auto">
                <h2 class="section-title text-4xl md:text-5xl font-bold text-slate-800 text-center pb-4 mb-12">Tech Forward</h2>
                <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
                    <div class="text-center p-6 bg-white rounded-2xl border border-slate-200">
                        <div class="text-5xl mb-4 text-blue-500">ü§ù</div>
                        <h3 class="text-xl font-bold text-slate-800 mb-2">Ice Breakers</h3>
                        <p class="text-slate-600">Fun activities to kickstart your coding sessions with friends.</p>
                    </div>
                    <div class="text-center p-6 bg-white rounded-2xl border border-slate-200">
                        <div class="text-5xl mb-4 text-blue-500">üìö</div>
                        <h3 class="text-xl font-bold text-slate-800 mb-2">Curriculum</h3>
                        <p class="text-slate-600">Structured learning paths from beginner to pro.</p>
                    </div>
                    <div class="text-center p-6 bg-white rounded-2xl border border-slate-200">
                        <div class="text-5xl mb-4 text-blue-500">‚ùì</div>
                        <h3 class="text-xl font-bold text-slate-800 mb-2">Quizzes</h3>
                        <p class="text-slate-600">Test your knowledge and earn badges.</p>
                    </div>
                    <div class="text-center p-6 bg-white rounded-2xl border border-slate-200">
                        <div class="text-5xl mb-4 text-blue-500">üèÜ</div>
                        <h3 class="text-xl font-bold text-slate-800 mb-2">Gamified Learning</h3>
                        <p class="text-slate-600">Unlock achievements and climb the leaderboards.</p>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Immersive Science Simulations Section -->
        <section id="simulations" class="py-20 px-4 bg-slate-100 reveal">
            <div class="container mx-auto">
                <h2 class="section-title text-4xl md:text-5xl font-bold text-slate-800 text-center pb-4 mb-12">Immersive Science Simulations</h2>
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <!-- Simulation Card -->
                    <div class="content-card rounded-2xl">
                        <img src="media/solar_system_explorer.jpg" alt="Solar System" class="w-full h-48 object-cover">
                        <div class="p-6 text-center">
                            <h3 class="text-2xl font-bold mb-2 text-slate-800">Solar System Explorer</h3>
                            <p class="text-slate-600 mb-6">Journey through our solar system in stunning 3D and learn about the planets.</p>
                            <a href="simulations/solarsystem.html" class="inline-block px-8 py-3 font-bold text-white rounded-full btn">Enter Simulation</a>
                        </div>
                    </div>
                    <div class="content-card rounded-2xl">
                        <img src="media/earth‚Äôs_magnetic_field.jpg" alt="Earth's Magnetic Field" class="w-full h-48 object-cover">
                        <div class="p-6 text-center">
                            <h3 class="text-2xl font-bold mb-2 text-slate-800">Earth‚Äôs Magnetic Field</h3>
                            <p class="text-slate-600 mb-6">Visualize the invisible magnetic forces that protect our planet from solar winds.</p>
                            <a href="simulations/magneticfield.html" class="inline-block px-8 py-3 font-bold text-white rounded-full btn">Enter Simulation</a>
                        </div>
                    </div>
                    <div class="content-card rounded-2xl">
                        <img src="media/solenoid_simulator.jpg" alt="Solenoid Simulation" class="w-full h-48 object-cover">
                        <div class="p-6 text-center">
                            <h3 class="text-2xl font-bold mb-2 text-slate-800">Solenoid Simulation</h3>
                            <p class="text-slate-600 mb-6">Experiment with electromagnets and learn about magnetic fields in this interactive lab.</p>
                            <a href="simulations/soleniod.html" class="inline-block px-8 py-3 font-bold text-white rounded-full btn">Enter Simulation</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Computer Literacy Games Section -->
        <section class="py-20 px-4 reveal">
            <div class="container mx-auto">
                <h2 class="section-title text-4xl md:text-5xl font-bold text-slate-800 text-center pb-4 mb-12">Computer Literacy Games</h2>
                <div class="grid md:grid-cols-3 gap-8">
                     <div class="content-card rounded-2xl">
                         <img src="media/typinggame.png" alt="Typing Game" class="w-full h-48 object-cover">
                         <div class="p-6 text-center">
                             <h3 class="text-2xl font-bold mb-2 text-slate-800">Typing Game</h3>
                             <p class="text-slate-600 mb-6">Improve your typing speed and accuracy with a series of fun and engaging challenges.</p>
                             <a href="computergame/namethetech.html" id="play-typing-game-btn" class="inline-block px-8 py-3 font-bold text-white rounded-full btn">Play Game</a>
                         </div>
                     </div>
                    <div class="content-card rounded-2xl">
                        <img src="media/hangman.png" alt="Hangman Game" class="w-full h-48 object-cover">
                        <div class="p-6 text-center">
                            <h3 class="text-2xl font-bold mb-2 text-slate-800">Hangman: Tech Edition</h3>
                            <p class="text-slate-600 mb-6">Guess the tech-related words before it's too late in this modern take on a classic game.</p>
                            <a href="computergame/hangman.html" class="inline-block px-8 py-3 font-bold text-white rounded-full btn">Play Game</a>
                        </div>
                    </div>
                    <div class="content-card rounded-2xl">
                        <img src="media/namethetech.png" alt="Name the Tech" class="w-full h-48 object-cover">
                        <div class="p-6 text-center">
                            <h3 class="text-2xl font-bold mb-2 text-slate-800">Name the Tech</h3>
                            <p class="text-slate-600 mb-6">Identify famous tech logos, hardware components, and software in this fun quiz game.</p>
                            <a href="computergame/namethetech.html" class="inline-block px-8 py-3 font-bold text-white rounded-full btn">Play Game</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-white border-t border-slate-200 text-slate-600">
        <div class="container mx-auto py-12 px-4 text-center">
            <div class="flex justify-center space-x-6 mb-6">
                <a href="#" class="hover:text-blue-500">About</a>
                <a href="#" class="hover:text-blue-500">Contact</a>
                <a href="#" class="hover:text-blue-500">Privacy Policy</a>
                <a href="#" class="hover:text-blue-500">Terms of Service</a>
            </div>
            <div class="flex justify-center space-x-6 mb-8">
                 <a href="#" class="hover:text-blue-500 transform hover:scale-125 transition-transform"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg></a>
                 <a href="#" class="hover:text-blue-500 transform hover:scale-125 transition-transform"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg></a>
                 <a href="#" class="hover:text-blue-500 transform hover:scale-125 transition-transform"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line></svg></a>
            </div>
            <p class="font-bold text-lg text-slate-800">Webmax Coding Hub ‚Äì <span class="text-blue-500">Play to Learn, Learn to Play.</span></p>
            <p class="mt-4 text-sm text-slate-500">&copy; <span id="current-year"></span> Webmax Coding Hub. All Rights Reserved.</p>
        </div>
    </footer>
    
    <!-- Typing Game Modal -->
    <div id="typing-game-modal" class="fixed inset-0 bg-slate-900/60 z-[100] items-center justify-center p-4 hidden">
        <div class="bg-white border border-slate-200 rounded-2xl shadow-xl p-6 md:p-8 max-w-3xl w-full relative transform transition-all duration-300 ease-in-out scale-95" id="modal-content">
            <button id="close-modal-btn" class="absolute top-3 right-4 text-slate-400 hover:text-slate-800 text-3xl font-bold">&times;</button>
            <h2 class="text-3xl font-bold text-center text-slate-800 mb-6">Typing Speed Test</h2>
            
            <div id="game-stats" class="grid grid-cols-3 gap-4 bg-slate-100 p-4 rounded-lg mb-6 text-center">
                <div>
                    <div class="text-sm text-slate-500 uppercase tracking-wider">Time</div>
                    <div id="timer" class="text-3xl font-bold text-blue-500">60s</div>
                </div>
                <div>
                    <div class="text-sm text-slate-500 uppercase tracking-wider">WPM</div>
                    <div id="wpm" class="text-3xl font-bold text-blue-500">0</div>
                </div>
                 <div>
                    <div class="text-sm text-slate-500 uppercase tracking-wider">Accuracy</div>
                    <div id="accuracy" class="text-3xl font-bold text-blue-500">100%</div>
                </div>
            </div>

            <div id="text-to-type" class="text-lg md:text-xl text-slate-700 p-4 border border-slate-200 rounded-lg bg-slate-50 mb-4 h-36 overflow-y-auto select-none"></div>
            
            <textarea id="typing-input" class="w-full p-4 border-2 border-slate-300 bg-white text-slate-800 rounded-lg text-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" placeholder="Start typing here..." rows="3" disabled></textarea>

            <div class="text-center mt-6">
                <button id="restart-btn" class="inline-block px-8 py-3 font-bold text-white rounded-full btn">Restart Test</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            // --- Intersection Observer for reveal-on-scroll effect ---
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.1 });

            const elementsToReveal = document.querySelectorAll('.reveal');
            elementsToReveal.forEach(el => observer.observe(el));

            // --- Dynamic year in footer ---
            const yearSpan = document.getElementById('current-year');
            if (yearSpan) {
                yearSpan.textContent = new Date().getFullYear();
            }

            // --- Typing Game Logic ---
            const playBtn = document.getElementById('play-typing-game-btn');
            const modal = document.getElementById('typing-game-modal');
            const modalContent = document.getElementById('modal-content');
            const closeBtn = document.getElementById('close-modal-btn');
            const restartBtn = document.getElementById('restart-btn');

            const textDisplay = document.getElementById('text-to-type');
            const inputArea = document.getElementById('typing-input');
            const timerDisplay = document.getElementById('timer');
            const wpmDisplay = document.getElementById('wpm');
            const accuracyDisplay = document.getElementById('accuracy');
            
            const QUOTES = [
                "The quick brown fox jumps over the lazy dog. This sentence contains every letter of the alphabet. Learning to type quickly and accurately is a valuable skill in today's digital world, opening doors to faster communication and increased productivity.",
                "JavaScript, often abbreviated as JS, is a programming language that is one of the core technologies of the World Wide Web, alongside HTML and CSS. As of 2023, 98.7% of websites use JavaScript on the client side for webpage behavior.",
                "A function is a block of code designed to perform a particular task. A function is executed when something invokes it (calls it). Functions are a fundamental building block in JavaScript. Think of them as a way to package up code so you can use it again.",
                "React is a free and open-source front-end JavaScript library for building user interfaces based on UI components. It is maintained by Meta and a community of individual developers and companies. React can be used as a base in the development of single-page or mobile applications."
            ];

            let timerInterval;
            let timeRemaining = 60;
            let gameStarted = false;
            let mistakes = 0;
            let charIndex = 0;

            function loadNewQuote() {
                const randomIndex = Math.floor(Math.random() * QUOTES.length);
                const quote = QUOTES[randomIndex];
                textDisplay.innerHTML = '';
                quote.split('').forEach(char => {
                    const charSpan = document.createElement('span');
                    charSpan.innerText = char;
                    charSpan.classList.add('text-char');
                    textDisplay.appendChild(charSpan);
                });
                if (textDisplay.children.length > 0) {
                   textDisplay.children[0].classList.add('current');
                }
            }

            function startGame() {
                if (gameStarted) return;
                gameStarted = true;
                inputArea.disabled = false;
                inputArea.focus();
                timerInterval = setInterval(updateTimer, 1000);
            }
            
            function updateTimer() {
                timeRemaining--;
                timerDisplay.textContent = `${timeRemaining}s`;
                if (timeRemaining <= 0) {
                    endGame();
                }
            }

            function endGame() {
                clearInterval(timerInterval);
                gameStarted = false;
                inputArea.disabled = true;
            }
            
            function calculateAccuracy() {
                if (charIndex === 0) {
                    accuracyDisplay.textContent = '100%';
                    return;
                }
                const correctChars = charIndex - mistakes;
                const accuracy = Math.round((correctChars / charIndex) * 100);
                accuracyDisplay.textContent = `${accuracy}%`;
            }

            function resetGame() {
                endGame();
                timeRemaining = 60;
                mistakes = 0;
                charIndex = 0;
                
                timerDisplay.textContent = '60s';
                wpmDisplay.textContent = '0';
                accuracyDisplay.textContent = '100%';
                inputArea.value = '';
                inputArea.disabled = true;
                loadNewQuote();
            }

            inputArea.addEventListener('input', () => {
                if (timeRemaining <= 0) return;
                if (!gameStarted) {
                    startGame();
                }
                
                const allChars = textDisplay.querySelectorAll('span');
                const typedValue = inputArea.value;
                
                charIndex = typedValue.length;
                mistakes = 0;

                allChars.forEach((charSpan, index) => {
                    const typedChar = typedValue[index];
                    if (typedChar == null) {
                        charSpan.className = 'text-char';
                    } else if (typedChar === charSpan.innerText) {
                        charSpan.className = 'text-char correct';
                    } else {
                        charSpan.className = 'text-char incorrect';
                        mistakes++;
                    }
                });
                
                for(let i=0; i < allChars.length; i++){
                    allChars[i].classList.remove('current');
                }
                if(charIndex < allChars.length){
                    allChars[charIndex].classList.add('current');
                }

                calculateAccuracy();
                
                const timeElapsed = 60 - timeRemaining;
                const correctChars = charIndex - mistakes;
                const currentWPM = timeElapsed > 0 ? Math.round(((correctChars / 5) / timeElapsed) * 60) : 0;
                wpmDisplay.textContent = currentWPM >= 0 ? currentWPM : 0;

                if (charIndex === allChars.length && mistakes === 0) {
                    endGame();
                }
            });

            // --- Modal handling ---
            playBtn.addEventListener('click', (e) => {
                e.preventDefault();
                modal.classList.remove('hidden');
                modal.classList.add('flex');
                setTimeout(() => modalContent.classList.remove('scale-95'), 10);
                resetGame();
                // Prompt user to start typing.
                inputArea.disabled = false;
                inputArea.placeholder = "Start typing here to begin the test...";
                inputArea.focus();
            });

            closeBtn.addEventListener('click', () => {
                modalContent.classList.add('scale-95');
                setTimeout(() => {
                    modal.classList.add('hidden');
                    modal.classList.remove('flex');
                }, 300);
                endGame();
            });

            restartBtn.addEventListener('click', () => {
                resetGame();
                inputArea.disabled = false;
                inputArea.placeholder = "Start typing here to begin the test...";
                inputArea.focus();
            });

            // Initial load of a quote
            loadNewQuote();
        });
    </script>
</body>
</html>