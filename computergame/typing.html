<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Typing Monster Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            touch-action: manipulation;
        }
        .font-fredoka {
            font-family: 'Fredoka One', cursive;
        }
        .game-bg {
            background: linear-gradient(180deg, #89f7fe 0%, #66a6ff 100%);
        }
        .word {
            position: absolute;
            background-color: #ffffff;
            color: #3b82f6;
            padding: 8px 16px;
            border-radius: 9999px;
            font-weight: 600;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.2s;
            border: 2px solid #ffffff;
        }
        .word.typed {
            background-color: #dbeafe;
            color: #1e40af;
        }
        .keyboard-key {
            transition: all 0.1s ease-in-out;
        }
        .keyboard-key.active {
            transform: scale(0.95);
            background-color: #60a5fa;
            border-color: #2563eb;
        }
        .feedback {
            animation: pop 0.3s ease-out;
        }
        @keyframes pop {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.8; }
            100% { transform: scale(1); opacity: 1; }
        }
        @keyframes fall {
            from { transform: translateY(-100px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .start-screen-animate {
            animation: fall 0.5s ease-out forwards;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

    <div id="game-container" class="w-full max-w-4xl mx-auto bg-white rounded-2xl shadow-2xl overflow-hidden">
        
        <!-- Start Screen -->
        <div id="start-screen" class="p-8 md:p-12 text-center">
            <div class="start-screen-animate">
                <!-- Cute Monster SVG -->
                <svg class="w-24 h-24 mx-auto text-blue-500 mb-4" viewBox="0 0 100 100" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path d="M84.3,63.9c-2.3-2.5-5.5-4-9-4c-0.6,0-1.2,0-1.8,0.1c-2-12.3-13.1-21.7-25.8-21.7c-12.7,0-23.8,9.4-25.8,21.7c-0.6-0.1-1.2-0.1-1.8-0.1c-3.5,0-6.7,1.5-9,4c-3.1,3.4-4.8,7.8-4.8,12.5c0,10.2,8.3,18.5,18.5,18.5h38.6c10.2,0,18.5-8.3,18.5-18.5C89.1,71.7,87.4,67.3,84.3,63.9z"/>
                    <path fill="#FFFFFF" d="M37.1,59.3c0,4.6-3.7,8.3-8.3,8.3s-8.3-3.7-8.3-8.3s3.7-8.3,8.3-8.3S37.1,54.7,37.1,59.3z"/>
                    <path fill="#FFFFFF" d="M79.4,59.3c0,4.6-3.7,8.3-8.3,8.3s-8.3-3.7-8.3-8.3s3.7-8.3,8.3-8.3S79.4,54.7,79.4,59.3z"/>
                    <path fill="#4A4A4A" d="M32.8,59.3c0,2.3-1.9,4.2-4.2,4.2s-4.2-1.9-4.2-4.2s1.9-4.2,4.2-4.2S32.8,57,32.8,59.3z"/>
                    <path fill="#4A4A4A" d="M75.1,59.3c0,2.3-1.9,4.2-4.2,4.2s-4.2-1.9-4.2-4.2s1.9-4.2,4.2-4.2S75.1,57,75.1,59.3z"/>
                    <path fill="#FFFFFF" d="M50,68.2c-7.2,0-13.3,4.1-16.5,10.1c1.9,1.6,4.3,2.6,6.9,2.6h19.2c2.6,0,5-1,6.9-2.6C63.3,72.3,57.2,68.2,50,68.2z"/>
                    <path d="M38.8,38.2c-1.6-1.1-2.9-2.5-3.8-4.2c-1-1.6-1.5-3.5-1.5-5.4c0-0.3,0-0.6,0-0.9c0.1-2.6,1.2-5,2.9-6.9c1.5-1.7,3.5-2.9,5.7-3.5c-0.1,0-0.2-0.1-0.3-0.1c-3.4-0.8-7.1,0.5-9.3,3.4c-2.9,3.7-2.9,9,0,12.7C34.7,40.1,36.9,40.1,38.8,38.2z"/>
                    <path d="M66.7,21.6c-2.2-2.9-5.9-4.2-9.3-3.4c-0.1,0-0.2,0-0.3,0.1c2.2,0.6,4.2,1.8,5.7,3.5c1.8,1.9,2.8,4.3,2.9,6.9c0,0.3,0,0.6,0,0.9c0,1.9-0.5,3.8-1.5,5.4c-0.9,1.6-2.2,3.1-3.8,4.2c1.9,1.9,4.1,1.9,5.9,0C72.5,33.5,72.5,28.2,66.7,21.6z"/>
                </svg>

                <h1 class="font-fredoka text-4xl md:text-5xl font-bold text-gray-800">Typing Monster</h1>
                <p class="mt-4 text-lg text-gray-600">Improve your typing speed and accuracy. Select a level to start!</p>
                
                <div id="level-selection" class="mt-8 grid grid-cols-2 md:grid-cols-4 gap-4 max-w-2xl mx-auto">
                    <button data-level="1" class="level-btn bg-green-500 hover:bg-green-600 text-white font-bold py-4 px-4 rounded-lg text-lg transition-transform transform hover:scale-105">Level 1</button>
                    <button data-level="2" class="level-btn bg-blue-500 hover:bg-blue-600 text-white font-bold py-4 px-4 rounded-lg text-lg transition-transform transform hover:scale-105">Level 2</button>
                    <button data-level="3" class="level-btn bg-purple-500 hover:bg-purple-600 text-white font-bold py-4 px-4 rounded-lg text-lg transition-transform transform hover:scale-105">Level 3</button>
                    <button data-level="4" class="level-btn bg-red-500 hover:bg-red-600 text-white font-bold py-4 px-4 rounded-lg text-lg transition-transform transform hover:scale-105">Level 4</button>
                </div>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="game-screen" class="hidden relative">
            <div class="p-4 bg-gray-50 border-b border-gray-200 flex justify-between items-center text-gray-700">
                <div><strong>Score:</strong> <span id="score" class="font-bold text-blue-600">0</span></div>
                <div><strong>Level:</strong> <span id="current-level" class="font-bold text-green-600">1</span></div>
                <div class="flex items-center">
                     <svg class="w-6 h-6 mr-1 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    <strong>Time:</strong> <span id="time" class="font-bold text-red-600">60</span>
                </div>
            </div>
            
            <div id="game-area" class="relative h-64 md:h-96 game-bg overflow-hidden">
                <!-- Words will be dynamically added here -->
            </div>

            <div class="p-4 bg-gray-100">
                <input type="text" id="input-box" class="w-full p-4 text-xl text-center border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-4 focus:ring-blue-300 focus:border-blue-500" placeholder="Start typing..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
            </div>
        </div>

        <!-- Game Over Screen -->
        <div id="game-over-screen" class="hidden p-8 md:p-12 text-center">
             <h2 class="font-fredoka text-4xl font-bold text-gray-800 mb-2">Time's Up!</h2>
             <p class="text-xl text-gray-600 mb-4">Your final score is:</p>
             <p id="final-score" class="font-fredoka text-7xl font-bold text-blue-500 mb-8">0</p>
             <div class="flex gap-4 justify-center">
                <button id="restart-btn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-8 rounded-lg text-lg transition-transform transform hover:scale-105">Play Again</button>
                <button id="main-menu-btn" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-8 rounded-lg text-lg transition-transform transform hover:scale-105">Main Menu</button>
             </div>
        </div>
    </div>

    <script>
        const startScreen = document.getElementById('start-screen');
        const gameScreen = document.getElementById('game-screen');
        const gameOverScreen = document.getElementById('game-over-screen');
        const levelButtons = document.querySelectorAll('.level-btn');
        
        const scoreDisplay = document.getElementById('score');
        const levelDisplay = document.getElementById('current-level');
        const timeDisplay = document.getElementById('time');
        const finalScoreDisplay = document.getElementById('final-score');
        
        const gameArea = document.getElementById('game-area');
        const inputBox = document.getElementById('input-box');
        
        const restartBtn = document.getElementById('restart-btn');
        const mainMenuBtn = document.getElementById('main-menu-btn');

        const GAME_TIME = 60; // seconds

        const wordsByLevel = {
            1: ['a', 's', 'd', 'f', 'j', 'k', 'l', ';'],
            2: ['ask', 'sad', 'lad', 'fall', 'fad', 'flask', 'dad'],
            3: ['hello', 'world', 'typing', 'game', 'speed', 'great', 'learn'],
            4: ['javascript', 'developer', 'challenge', 'keyboard', 'accuracy', 'programming']
        };

        let score = 0;
        let time = GAME_TIME;
        let currentLevel = 1;
        let isPlaying = false;
        let timer;
        let wordFallInterval;
        let activeWords = [];

        // --- Event Listeners ---
        levelButtons.forEach(button => {
            button.addEventListener('click', () => {
                currentLevel = parseInt(button.dataset.level);
                startGame();
            });
        });

        inputBox.addEventListener('input', handleTyping);
        restartBtn.addEventListener('click', startGame);
        mainMenuBtn.addEventListener('click', showMainMenu);

        // --- Game Flow ---
        function startGame() {
            showScreen(gameScreen);
            levelDisplay.textContent = currentLevel;
            isPlaying = true;
            score = 0;
            time = GAME_TIME;
            scoreDisplay.textContent = score;
            timeDisplay.textContent = time;
            
            inputBox.value = '';
            inputBox.focus();

            clearInterval(timer);
            timer = setInterval(updateTime, 1000);

            clearInterval(wordFallInterval);
            wordFallInterval = setInterval(addWord, 1500 / (currentLevel * 0.75));
            
            // Clear any old words
            activeWords.forEach(wordObj => wordObj.element.remove());
            activeWords = [];
            addWord(); // Add first word immediately
        }

        function updateTime() {
            if (time > 0) {
                time--;
                timeDisplay.textContent = time;
            } else if (isPlaying) {
                endGame();
            }
        }

        function endGame() {
            isPlaying = false;
            clearInterval(timer);
            clearInterval(wordFallInterval);
            finalScoreDisplay.textContent = score;
            showScreen(gameOverScreen);
        }

        function showMainMenu() {
            showScreen(startScreen);
        }

        // --- Word & Typing Logic ---
        function addWord() {
            if (!isPlaying) return;

            const wordList = wordsByLevel[currentLevel];
            const text = wordList[Math.floor(Math.random() * wordList.length)];
            
            const wordElement = document.createElement('div');
            wordElement.classList.add('word');
            wordElement.textContent = text;

            // Ensure words don't overlap horizontally
            const gameAreaWidth = gameArea.offsetWidth;
            const wordWidth = text.length * 12 + 32; // Approximate width
            const randomX = Math.random() * (gameAreaWidth - wordWidth);
            
            wordElement.style.left = `${randomX}px`;
            wordElement.style.top = `-30px`; // Start above the screen

            gameArea.appendChild(wordElement);
            
            const wordObj = {
                text: text,
                element: wordElement,
                y: -30,
                speed: Math.random() * 0.5 + (0.5 * currentLevel)
            };

            activeWords.push(wordObj);
        }

        function handleTyping() {
            const typedValue = inputBox.value.trim();
            const matchingWordIndex = activeWords.findIndex(wordObj => wordObj.text === typedValue);

            if (matchingWordIndex !== -1) {
                const wordObj = activeWords[matchingWordIndex];
                
                // Feedback effect
                wordObj.element.classList.add('feedback');
                wordObj.element.style.transform = 'scale(1.2)';
                wordObj.element.style.backgroundColor = '#4ade80'; // Green
                wordObj.element.style.color = '#ffffff';

                setTimeout(() => {
                    wordObj.element.remove();
                }, 200);

                activeWords.splice(matchingWordIndex, 1);
                
                inputBox.value = '';
                score += wordObj.text.length;
                scoreDisplay.textContent = score;
            }
        }
        
        function updateWordPositions() {
            // The animation loop now only checks if the game is playing inside the loop,
            // but the loop itself runs continuously.
            if (isPlaying) {
                const gameAreaHeight = gameArea.offsetHeight;

                for (let i = activeWords.length - 1; i >= 0; i--) {
                    const wordObj = activeWords[i];
                    wordObj.y += wordObj.speed;
                    wordObj.element.style.top = `${wordObj.y}px`;

                    // If word reaches the bottom
                    if (wordObj.y > gameAreaHeight) {
                        wordObj.element.remove();
                        activeWords.splice(i, 1);
                        // Optional: penalize player
                        // score = Math.max(0, score - 2); 
                        // scoreDisplay.textContent = score;
                    }
                }
            }
            // This line creates the continuous animation loop.
            requestAnimationFrame(updateWordPositions);
        }

        // --- Utility ---
        function showScreen(screenToShow) {
            [startScreen, gameScreen, gameOverScreen].forEach(screen => {
                screen.classList.add('hidden');
            });
            screenToShow.classList.remove('hidden');
        }

        // Initialize
        showScreen(startScreen);
        requestAnimationFrame(updateWordPositions);

    </script>
</body>
</html>